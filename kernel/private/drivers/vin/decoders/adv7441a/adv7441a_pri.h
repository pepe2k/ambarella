/*
 * kernel/private/drivers/ambarella/vin/decoders/adv7441a/adv7441a_pri.h
 *
 * History:
 *    2009/07/23 - [Qiao Wang] Copy form adv7443
 *
 * Copyright (C) 2004-2009, Ambarella, Inc.
 *
 * All rights reserved. No Part of this file may be reproduced, stored
 * in a retrieval system, or transmitted, in any form, or by any means,
 * electronic, mechanical, photocopying, recording, or otherwise,
 * without the prior consent of Ambarella, Inc.
 *
 */

#ifndef __ADV7441A_PRI_H__
#define __ADV7441A_PRI_H__

enum adv7441a_register_map {
	USER_MAP = 0,//0x42
	USER_MAP_1,//
	USER_MAP_2,
	VDP_MAP,
	HDMI_MAP, 
	KSV_MAP,
	EDID_MAP,
	RESERVED_MAP,
};

#define ADV7441A_HDMI_MIN_ID			(0x10)
#define ADV7441A_FIXED_FPORCH			1
#define ADV7441A_AB031_205			1
#define ADV7441A_RETRY_COUNT			(15)
#define ADV7441A_RETRY_FIX			(10)
#define ADV7441A_RETRY_SLEEP_MS			(200)
#define ADV7441A_EDID_TABLE_SIZE		(256)

/*      Name				Reg#	Description (16-bit content)*/
/*user Map register*/
#define ADV7441A_REG_INPUTCTRL			0x00
#define ADV7441A_REG_OUTCTRL			0x03
#define ADV7441A_REG_PRIMODE			0x05
#define ADV7441A_REG_VID_STD			0x06	/* bit[4:0] expanded functionality */
#define ADV7441A_REG_AUTO_DETECT_REG		0x07
#define ADV7441A_REG_USS2			0x0e
#define ADV7441A_REG_PWR			0x0f
#define ADV7441A_REG_STATUS1			0x10
#define ADV7441A_REG_IDENT			0x11
#define ADV7441A_REG_STATUS3			0x13

#define ADV7441A_REG_STDI_REG			0x86
#define ADV7441A_REG_STDI_DVALID_REG		0xb1
#define ADV7441A_REG_BL_REG			0xb2
#define ADV7441A_REG_SCVS_REG			0xb3
#define ADV7441A_REG_SCF_REG			0xb4

/*user Map 1*/
#define ADV7441A_REG_INT1MSK1			0x44
#define ADV7441A_REG_INT1CLR1			0x42
#define ADV7441A_REG_INT1MSK2			0x48
#define ADV7441A_REG_INT1CLR2			0x46
#define ADV7441A_REG_INT1MSK3			0x4c
#define ADV7441A_REG_INT1CLR3			0x4a
#define ADV7441A_REG_HDMIINT2MSK1		0x62
#define ADV7441A_REG_HDMIINT2MSK2		0x66
#define ADV7441A_REG_HDMIINTSTUS2		0x65
#define ADV7441A_REG_HDMIRAWSTUS1		0x60
#define ADV7441A_REG_HDMIRAWSTUS3		0x68
#define ADV7441A_REG_HDMIINTSTUS4		0x6c

/*user Map 2*/
#define ADV7441A_REG_HID			0xea
#define ADV7441A_REG_USS1			0xeb
#define ADV7441A_REG_VDP			0xec
#define ADV7441A_REG_KSV			0xed
#define ADV7441A_REG_EDID			0xee
#define ADV7441A_REG_HDMI			0xef

/*KSV Map*/
#define ADV7441A_REG_BCAPS			0x40
#define ADV7441A_REG_CTRL_BITS			0x73

/*hdmi Map*/
#define ADV7441A_REG_HDMIPORTSEL		0x00
#define ADV7441A_REG_AVIINFOVER			0x80
#define ADV7441A_REG_AVIINFODATA1		0x81
#define ADV7441A_REG_AVIINFODATA2 		0x82
#define ADV7441A_REG_AVIINFODATA3 		0x83
#define ADV7441A_REG_AVIINFODATA4		0x84
#define ADV7441A_REG_AVIINFODATA5		0x85
#define ADV7441A_REG_AVIINFODATA6		0x86
#define ADV7441A_REG_REG04			0x04
#define ADV7441A_REG_REG05			0x05
#define ADV7441A_REG_REG07			0x07
#define ADV7441A_REG_LW				0x08
#define ADV7441A_REG_F0HMSB			0x09
#define ADV7441A_REG_F0HLSB			0x0a
#define ADV7441A_REG_F1HMSB			0x0b
#define ADV7441A_REG_F1HLSB			0x0c
#define ADV7441A_REG_HSFPMSB			0x20
#define ADV7441A_REG_HSFPLSB			0x21
#define ADV7441A_REG_HSPWMSB			0x22
#define ADV7441A_REG_HSPWLSB			0x23
#define ADV7441A_REG_HSBPMSB			0x24
#define ADV7441A_REG_HSBPLSB			0x25
#define ADV7441A_REG_F0VSFPMSB			0x2a
#define ADV7441A_REG_F0VSFPLSB			0x2b
#define ADV7441A_REG_F1VSFPMSB			0x2c
#define ADV7441A_REG_F1VSFPLSB			0x2d
#define ADV7441A_REG_F0VSPWMSB			0x2e
#define ADV7441A_REG_F0VSPWLSB			0x2f
#define ADV7441A_REG_F1VSPWMSB			0x30
#define ADV7441A_REG_F1VSPWLSB			0x31
#define ADV7441A_REG_F0VSBPMSB			0x32
#define ADV7441A_REG_F0VSBPLSB			0x33
#define ADV7441A_REG_F1VSBPMSB			0x34
#define ADV7441A_REG_F1VSBPLSB			0x35

/*--------------------------Register value mask or setting---------------------------------*/
#define ADV7441A_IDENT_ID_MASK 			0xff
#define ADV7441A_IDENT_ID_ES3			0x05
#define ADV7441A_IDENT_ID_ES4			0x06

#define ADV7441A_PWR_RST_MASK			0x80
#define ADV7441A_PWR_RST_NORMAL			0x00
#define ADV7441A_PWR_RST_RST			0x80

#define ADV7441A_STATUS1_ADRES_MASK			0x70
#define ADV7441A_STATUS1_ADRES_NTSM			0x00
#define ADV7441A_STATUS1_ADRES_NTSC443		0x10
#define ADV7441A_STATUS1_ADRES_PALM			0x20
#define ADV7441A_STATUS1_ADRES_PAL60		0x30
#define ADV7441A_STATUS1_ADRES_PAL			0x40
#define ADV7441A_STATUS1_ADRES_SECAM		0x50
#define ADV7441A_STATUS1_ADRES_PALN			0x60
#define ADV7441A_STATUS1_ADRES_SECAM525		0x70

#define ADV7441A_STATUS1_INLOCK_MASK		0x03
#define ADV7441A_STATUS1_INLOCK_LOCK		0x01
#define ADV7441A_STATUS1_INLOCK_UNLOCK		0x00

#define ADV7441A_STATUS1_FSCLOCK_MASK		0x04
#define ADV7441A_STATUS1_FSCLOCK_LOCK		0x04
#define ADV7441A_STATUS1_FSCLOCK_UNLOCK		0x00

#define ADV7441A_STATUS3_SDOP_MASK			0x04
#define ADV7441A_STATUS3_SDOP_50HZ 			0x01
#define ADV7441A_STATUS3_SDOP_60HZ			0x00
	
#define ADV7441A_STATUS3_INTL_MASK			0x40
#define ADV7441A_STATUS3_INTL_INTL			0x40
#define ADV7441A_STATUS3_INTL_PROG			0x00

#define ADV7441A_OUTCTRL_DUPAV_MASK			0x01
#define ADV7441A_OUTCTRL_DUPAV_8BITINTL		0x00
#define ADV7441A_OUTCTRL_DUPAV_16BITDUP		0x01

#define ADV7441A_OUTCTRL_OFSEL_MASK			0x3c
#define ADV7441A_OUTCTRL_OFSEL_10BIT656		0x00
#define ADV7441A_OUTCTRL_OFSEL_20BIT		0x04
#define ADV7441A_OUTCTRL_OFSEL_16BIT		0x08
#define ADV7441A_OUTCTRL_OFSEL_8BIT656		0x0c
#define ADV7441A_OUTCTRL_OFSEL_30BIT		0x10
#define ADV7441A_OUTCTRL_OFSEL_24BIT		0x14

#define ADV7441A_INPUTCTRL_INSEL_MASK		0x0f
#define ADV7441A_INPUTCTRL_INSEL_CVBS_AIN1	0x00
#define ADV7441A_INPUTCTRL_INSEL_CVBS_AIN2	0x01
#define ADV7441A_INPUTCTRL_INSEL_CVBS_AIN3	0x02
#define ADV7441A_INPUTCTRL_INSEL_CVBS_AIN4	0x03
#define ADV7441A_INPUTCTRL_INSEL_CVBS_AIN5	0x04
#define ADV7441A_INPUTCTRL_INSEL_CVBS_AIN6	0x05
#define ADV7441A_INPUTCTRL_INSEL_YC_AIN14	0x06
#define ADV7441A_INPUTCTRL_INSEL_YC_AIN25	0x07
#define ADV7441A_INPUTCTRL_INSEL_YC_AIN36	0x08
#define ADV7441A_INPUTCTRL_INSEL_YPBPR_AIN145	0x09
#define ADV7441A_INPUTCTRL_INSEL_YPBPR_AIN236	0x0a
#define ADV7441A_INPUTCTRL_INSEL_CVBS_AIN7	0x0b
#define ADV7441A_INPUTCTRL_INSEL_CVBS_AIN8	0x0c
#define ADV7441A_INPUTCTRL_INSEL_CVBS_AIN9	0x0d
#define ADV7441A_INPUTCTRL_INSEL_CVBS_AIN10	0x0e
#define ADV7441A_INPUTCTRL_INSEL_CVBS_AIN11	0x0f

#define ADV7441A_HDMIPORTSEL_PORT_MASK		0x01
#define ADV7441A_HDMIPORTSEL_PORT_A		0x00
#define ADV7441A_HDMIPORTSEL_PORT_B		0x01

#define ADV7441A_HDMIRAWSTUTS1_AVIINFO_MASK	0x01
#define ADV7441A_HDMIRAWSTUTS1_AVIINFO_NODET	0x00
#define ADV7441A_HDMIRAWSTUTS1_AVIINFO_DET	0x01

#define ADV7441A_HDMIRAWSTUTS3_TMDSCLKB_MASK	0x08
#define ADV7441A_HDMIRAWSTUTS3_TMDSCLKB_NO	0x00
#define ADV7441A_HDMIRAWSTUTS3_TMDSCLKB_YES	0x08

#define ADV7441A_HDMIRAWSTUTS3_TMDSCLKA_MASK	0x10
#define ADV7441A_HDMIRAWSTUTS3_TMDSCLKA_NO	0x00
#define ADV7441A_HDMIRAWSTUTS3_TMDSCLKA_YES	0x10

#define ADV7441A_HDMIRAWSTUTS3_CLKLOCK_MASK	0x81
#define ADV7441A_HDMIRAWSTUTS3_CLKLOCK_NOLOCK	0x00
#define ADV7441A_HDMIRAWSTUTS3_CLKLOCK_LOCKED	0x81

#define ADV7441A_HDMIINTSTUTS4_NEWAVIINFO_MASK	0x01
#define ADV7441A_HDMIINTSTUTS4_NEWAVIINFO_NONEW	0x00
#define ADV7441A_HDMIINTSTUTS4_NEWAVIINFO_NEW	0x01

#define ADV7441A_AVIINFODATA1_SI_MASK		0x03
#define ADV7441A_AVIINFODATA1_SI_NODATA		0x00
#define ADV7441A_AVIINFODATA1_SI_OS		0x01
#define ADV7441A_AVIINFODATA1_SI_US		0x02
#define ADV7441A_AVIINFODATA1_SI_RSVD		0x03

#define ADV7441A_AVIINFODATA1_CF_MASK		0x60
#define ADV7441A_AVIINFODATA1_CF_RGB		0x00
#define ADV7441A_AVIINFODATA1_CF_YUV422		0x20
#define ADV7441A_AVIINFODATA1_CF_YUV444		0x40
#define ADV7441A_AVIINFODATA1_CF_RSVD		0x60

#define ADV7441A_AVIINFODATA2_AAR_MASK		0x0f
#define ADV7441A_AVIINFODATA2_AAR_ASPIC		0x08
#define ADV7441A_AVIINFODATA2_AAR_43		0x09
#define ADV7441A_AVIINFODATA2_AAR_169		0x0a
#define ADV7441A_AVIINFODATA2_AAR_149		0x0b

#define ADV7441A_AVIINFODATA2_PAR_MASK		0x30
#define ADV7441A_AVIINFODATA2_PAR_NODATA	0x00
#define ADV7441A_AVIINFODATA2_PAR_43		0x10
#define ADV7441A_AVIINFODATA2_PAR_169		0x20
#define ADV7441A_AVIINFODATA2_PAR_RSVD		0x30

#define ADV7441A_AVIINFODATA4_VIC_MASK		0x7f

#define ADV7441A_REG04_LOCK_MASK		0x02
#define ADV7441A_REG04_LOCK_LOCKED		0x02

#define ADV7441A_REG05_HDMIMODE_MASK		0x80
#define ADV7441A_REG05_HDMIMODE_DVI		0x00
#define ADV7441A_REG05_HDMIMODE_HDMI		0x80

#define ADV7441A_REG05_HDCP_MASK		0x40
#define ADV7441A_REG05_HDCP_INUSE		0x40
#define ADV7441A_REG05_HDCP_NOUSE		0x00

#define ADV7441A_REG07_DE_MASK			0x10
#define ADV7441A_REG07_DE_LOCKED		0x10
#define ADV7441A_REG07_DE_UNLOCK		0x00

#define ADV7441A_REG07_LOCK_MASK		0x50
#define ADV7441A_REG07_LOCK_LOCKED		0x50

#define ADV7441A_REG07_LW11TO8_MASK		0x0f
#define ADV7441A_F0HMSB_MSB_MASK		0x0f
#define ADV7441A_F1HMSB_MSB_MASK		0x0f
#define ADV7441A_HSFPMSB_MSB_MASK		0x03
#define ADV7441A_HSPWMSB_MSB_MASK		0x03
#define ADV7441A_HSBPMSB_MSB_MASK		0x03
#define ADV7441A_F0VSFPMSB_MSB_MASK		0x1f
#define ADV7441A_F1VSFPMSB_MSB_MASK		0x1f
#define ADV7441A_F0VSBPMSB_MSB_MASK		0x1f
#define ADV7441A_F1VSBPMSB_MSB_MASK		0x1f

#define ADV7441A_STDI_DVALID_MSK		0x80
#define ADV7441A_STDI_DVALID			0x80

#define ADV7441A_BL_H6B_MSK			0x3f
#define ADV7441A_OSC_CLK_FREQ			28636	/* KHz */
#define ADV7441A_BL_CLK_FREQ			27000	/* KHz */

#define ADV7441A_SCVS_MSK				0xf8
#define ADV7441A_SCF_L3B_MSK			0x07

#define ADV7441A_EDID_A_ENABLE			0x04
#define ADV7441A_EDID_B_ENABLE			0x02

#define ADV7441A_BCAPS_HDMI_ENABLE		0x80
#define ADV7441A_BCAPS_DEFAULT			0x01

#define ADV7441A_CLOCK_TERM_PORT_B		0x20
#define ADV7441A_CLOCK_TERM_PORT_A		0x40
/* ========================================================================== */

struct adv7441a_reg_table {
	u8 regmap;
	u8 reg;
	u8 data;
};

enum adv7441a_processor_type {
	ADV7441A_PROCESSOR_SDP = 0,
	ADV7441A_PROCESSOR_CP,
	ADV7441A_PROCESSOR_HDMI,
};

struct adv7441a_source_info {
	char name[32];
	u32 source_id;
	enum adv7441a_processor_type source_processor;
	enum amba_vin_decoder_source_type source_type;
	const struct adv7441a_reg_table *pregtable;
};

struct adv7441a_vid_stds {
	enum amba_video_mode cap_vin_mode;
	u16 cap_start_x;
	u16 cap_start_y;
	u16 sync_start;
	u16 cap_cap_w;
	u16 cap_cap_h;
	u8 video_system;
	u32 frame_rate;
	u8 aspect_ratio;
	u8 input_type;
	u8 video_format;
	u8 bit_resolution;
	u8 vfr;
	u8 input_format;
	u32 so_freq_hz;
	u32 so_pclk_freq_hz;
	const struct adv7441a_reg_table *fix_reg_table;

	u16 bl_low;
	u16 bl_upper;
	u16 scf_low;
	u16 scf_upper;
	u16 scvs_low;
	u16 scvs_upper;
};

#endif /* __ADV7441A_PRI_H__ */

